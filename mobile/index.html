<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"/>
<title>EURO247 - Mobile</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
/* Reset and Globals */
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%}
body{font-family:-apple-system,BlinkMacSystemFont,'Noto Sans KR',sans-serif;background:#0f1215;color:#eaf2ff}

/* ===== Vars ===== */
:root{
  --gap:clamp(6px,2vw,12px);
  --side:16px;
  --H-header:56px; --H-member:64px; --H-bottom:64px;
  --bd:#2a2f36;
}

/* ===== Header & member ===== */
header{position:fixed;left:0;right:0;top:0;z-index:1000;background:#13161b;border-bottom:1px solid #232a34;padding:12px var(--side)}
#logoSlot{display:flex;align-items:center;gap:10px;font-size:clamp(18px,5vw,24px);font-weight:900}
#memberSlot{position:fixed;left:0;right:0;top:var(--H-header);height:var(--H-member);padding:0 var(--side);background:#13161b;border-bottom:1px solid var(--bd);z-index:900;display:flex;gap:var(--gap);align-items:center}
.btn-member{flex:1;height:40px;border:1px solid var(--bd);border-radius:8px;font-size:15px;font-weight:700}
#btnJoin{background:linear-gradient(180deg,#1a2b45,#132237);color:#fff}
#btnLogin{background:linear-gradient(180deg,#2b1733,#231327);color:#fff}

/* ===== Main Layout ===== */
main{padding-top:calc(var(--H-header) + var(--H-member));padding-bottom:var(--H-bottom);min-height:100%}
.content{padding:0 var(--side);max-width:600px;margin:0 auto}
.section{margin-bottom:24px}
.grid-head{font-size:18px;font-weight:900;margin-bottom:12px}

/* ===== Hero (Mobile) ===== */
#heroSlot{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap);margin-bottom:var(--gap)}
.hero-card{aspect-ratio:1/1;position:relative;overflow:hidden;border-radius:12px}
.hero-card img{width:100%;height:100%;object-fit:cover}
.name-line{display:flex;align-items:center;gap:6px;font-size:14px}
.tg-ico{display:inline-flex;width:16px;height:16px;opacity:.9}
.tg-ico svg{width:16px;height:16px}

/* ===== 6 Cards (Mobile) ===== */
.six-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--gap)}
.six-grid .card{border:1px solid var(--bd);border-radius:12px;overflow:hidden;background:#171a1f}
.card-body{padding:12px}
.card-title{font-weight:700;font-size:16px}
.card-sub{font-size:12px;color:#9ca3af;margin-top:4px}

/* ===== Promo Grid (Mobile) ===== */
.promo-grid{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap);grid-auto-rows:80px}
.promo-grid .card{position:relative;border-radius:10px;overflow:hidden;background:linear-gradient(180deg,#151b21,#11161b);box-shadow:0 0 0 1px rgba(120,160,200,.18) inset}
.excl-big{grid-column:span 2;grid-row:span 2}
.promo-holder{position:absolute;inset:0}
.promo-holder img{width:100%;height:100%;object-fit:cover;filter:brightness(.9)}
.promo-title{position:absolute;font-weight:700;font-size:14px;padding:10px;text-shadow:0 2px 5px rgba(0,0,0,.6)}
.promo-title.tl{top:0;left:0}.promo-title.tr{top:0;right:0;text-align:right}
.promo-title.bl{bottom:0;left:0}.promo-title.br{bottom:0;right:0;text-align:right}

/* ===== Bottom Nav (Mobile) ===== */
#bottomNav{position:fixed;left:0;right:0;bottom:0;z-index:1000;height:var(--H-bottom);background:#13161b;border-top:1px solid var(--bd);display:flex;justify-content:space-around;align-items:center}
.nav-btn{display:flex;flex-direction:column;align-items:center;font-size:12px;color:#94a3b8}

/* ===== Modals (Join/Login/Done) ===== */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.65);z-index:10000;padding:var(--side)}
.modal .win{width:100%;max-width:400px;background:#12161c;border:1px solid var(--bd);border-radius:14px;padding:20px}
.modal .hd{display:flex;align-items:center;justify-content:space-between}
.modal .title{font-size:18px;font-weight:800}
.modal .close{color:#cbd5e1;cursor:pointer;font-size:24px}
.modal label{display:block;color:#94a3b8;font-size:14px}
.modal label input, .modal select{margin-top:4px;outline:none;width:100%;padding:10px 12px;border-radius:6px;background:#0f1318;border:1px solid #2a2f36}

/* Input group style for duplicate check (Mobile) */
.input-group{display:flex;align-items:center;gap:8px;margin-top:4px}
.input-group input{flex:1 !important;margin-top:0 !important;width:auto !important}
.input-group .btn-duplicate{flex-shrink:0;padding:.5rem .75rem;border-radius:.375rem;background:#2a2f36;color:white;font-size:12px;white-space:nowrap}

/* Survey-specific styles (Mobile) */
.survey-title{font-weight:700;font-size:16px;line-height:1.4;white-space:pre-wrap;color:#eaf2ff}
.survey-field{display:grid;gap:10px;margin-top:14px}
.survey-field .radio{display:flex;align-items:center;padding:10px 12px;border:1px solid #2a2f36;border-radius:8px;cursor:pointer;background:#171a1f;color:#cbd5e1}
.survey-field .radio:has(input:checked){border-color:#0ea5e9;background:#11151a}
.survey-field .radio input{margin-right:10px;transform:scale(1.2);cursor:pointer;flex-shrink:0}
.survey-field .input{padding:10px 12px;border:1px solid #2a2f36;border-radius:8px;background:#0f1318}
.survey-actions{display:flex;justify-content:space-between;gap:10px;margin-top:18px}
</style>
</head>
<body>

<header>
  <div id="logoSlot"><img style="height:28px" src="assets/logo_euro247.png" alt="EURO247"></div>
</header>
<div id="memberSlot">
  <button class="btn-member" id="btnJoin">ê°€ì…</button>
  <button class="btn-member" id="btnLogin">ë¡œê·¸ì¸</button>
  <button id="btnVip" class="btn-member" style="flex:0;width:80px;background:linear-gradient(180deg,#2d3a1c,#1e2812);color:#fff">VIP</button>
</div>

<main>
  <div class="content">

    <div class="section" id="heroSec">
      <div id="heroSlot">
        <div class="hero-card" style="background:linear-gradient(180deg,#1b2128,#14191e)">
          <img src="assets/hero_left.jpg" alt="Jayme Sun" onerror="this.style.display='none'">
          <div class="absolute left-3 bottom-3 text-white">
            <div class="text-xs text-neutral-300">Jayme Sun</div>
            <div class="name-line font-bold">Executive Host
              <span class="tg-ico" title="Telegram">
                <svg viewBox="0 0 24 24" fill="#29A9EA"><path d="M9.2 16.9 8.9 20c.4 0 .6-.2.8-.4l2-1.9 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.7c.3-1.2-.4-1.7-1.2-1.4L2.7 9.7c-1.2.5-1.2 1.1-.2 1.4l4.2 1.3L18.7 6c.6-.4 1.1-.2.7.2L9.2 16.9z"/></svg>
              </span>
            </div>
          </div>
        </div>
        <div class="hero-card" style="background:linear-gradient(180deg,#1b2128,#14191e)">
          <img src="assets/hero_mid.jpg" alt="Tom Woo" onerror="this.style.display='none'">
          <div class="absolute left-3 bottom-3 text-white">
            <div class="text-xs text-neutral-300">Tom Woo</div>
            <div class="name-line font-bold">Executive Host
              <a class="tg-ico" href="https://t.me/exid333" target="_blank" rel="noopener" title="Telegram">
                <svg viewBox="0 0 24 24" fill="#29A9EA"><path d="M9.2 16.9 8.9 20c.4 0 .6-.2.8-.4l2-1.9 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.7c.3-1.2-.4-1.7-1.2-1.4L2.7 9.7c-1.2.5-1.2 1.1-.2 1.4l4.2 1.3L18.7 6c.6-.4 1.1-.2.7.2L9.2 16.9z"/></svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="section">
      <div class="promo-grid">
        <button id="promo-big" class="card excl-big" data-img="PRO_BIG" style="position:relative;cursor:pointer">
          <div class="promo-holder"></div>
          <div class="absolute p-4 text-left text-white"><div class="text-xl font-bold">í€´ì¦ˆë§Œì !ì¿ í°ë§Œì !</div></div>
        </button>
        <button class="card promo-card" data-go="#page-official" data-img="PRO1"><div class="promo-holder"></div><div class="promo-title tl">ê³µì‹í”„ë¡œëª¨ì…˜</div></button>
        <button class="card promo-card" data-go="#page-partner"  data-img="PRO2"><div class="promo-holder"></div><div class="promo-title tr">íŒŒíŠ¸ë„ˆí”„ë¡œëª¨ì…˜</div></button>
        <button class="card promo-card" data-go="#page-now"      data-img="PRO3"><div class="promo-holder"></div><div class="promo-title bl">ì§€ê¸ˆì§„í–‰ì¤‘</div></button>
        <button class="card promo-card" data-go="#page-join"     data-img="PRO4"><div class="promo-holder"></div><div class="promo-title br">í”„ë¡œëª¨ì…˜ì°¸ì—¬</div></button>
      </div>
    </div>

    <div class="section">
      <div class="grid-head">ì‹ ê·œì¿ í°</div>
      <div class="six-grid">
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(0,70%,60%),hsl(60,50%,45%))"></div><div class="card-body"><div class="card-title">30,000 ìŠ¬ë¡¯ì „ìš©ì¿ í°</div><div class="card-sub">ì‚¬ìš© ì™„ë£Œ</div></div></div>
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(17,70%,60%),hsl(77,50%,45%))"></div><div class="card-body"><div class="card-title">20,000 ì¦‰ì„ì¿ í°</div><div class="card-sub">3ë“±ê¸‰ì‚¬ìš©ê°€ëŠ¥</div></div></div>
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(34,70%,60%),hsl(94,50%,45%))"></div><div class="card-body"><div class="card-title">30,000 ì¦‰ì„ì¿ í°</div><div class="card-sub">ì‚¬ìš© ì™„ë£Œ</div></div></div>
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(51,70%,60%),hsl(111,50%,45%))"></div><div class="card-body"><div class="card-title">60,000 ë¡¤ë§ì¿ í°</div><div class="card-sub">3ë“±ê¸‰ì‚¬ìš©ê°€ëŠ¥</div></div></div>
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(68,70%,60%),hsl(128,50%,45%))"></div><div class="card-body"><div class="card-title">70,000 VIPì¿ í°</div><div class="card-sub">ì‚¬ìš© ì™„ë£Œ</div></div></div>
        <div class="card"><div style="aspect-ratio:1/1;background:linear-gradient(180deg,hsl(85,70%,60%),hsl(145,50%,45%))"></div><div class="card-body"><div class="card-title">100,000 VIPì¿ í°</div><div class="card-sub">ì‚¬ìš© ì™„ë£Œ</div></div></div>
      </div>
    </div>

  </div>
</main>

<div id="bottomNav">
  <button class="nav-btn"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M12 2a10 10 0 0 0-9 5.5l9 6 9-6A10 10 0 0 0 12 2zm0 18a10 10 0 0 0 9-5.5l-9-6-9 6a10 10 0 0 0 9 5.5z"/></svg>í™ˆ</button>
  <button class="nav-btn"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M12 2a10 10 0 0 0-9 5.5l9 6 9-6A10 10 0 0 0 12 2zm0 18a10 10 0 0 0 9-5.5l-9-6-9 6a10 10 0 0 0 9 5.5z"/></svg>ì´ë²¤íŠ¸</button>
  <button class="nav-btn" style="color:#0ea5e9"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M12 2a10 10 0 0 0-9 5.5l9 6 9-6A10 10 0 0 0 12 2zm0 18a10 10 0 0 0 9-5.5l-9-6-9 6a10 10 0 0 0 9 5.5z"/></svg>íŒŒíŠ¸ë„ˆ</button>
  <button class="nav-btn"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M12 2a10 10 0 0 0-9 5.5l9 6 9-6A10 10 0 0 0 12 2zm0 18a10 10 0 0 0 9-5.5l-9-6-9 6a10 10 0 0 0 9 5.5z"/></svg>ê³ ê°ì„¼í„°</button>
  <button class="nav-btn"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M12 2a10 10 0 0 0-9 5.5l9 6 9-6A10 10 0 0 0 12 2zm0 18a10 10 0 0 0 9-5.5l-9-6-9 6a10 10 0 0 0 9 5.5z"/></svg>ë§ˆì´í˜ì´ì§€</button>
</div>


<div id="joinModal" class="modal">
  <div class="win">
    <div class="hd"><div class="title">ê°€ì…ì°½</div><button id="joinClose" class="close">âœ•</button></div>
    <form id="joinForm" class="mt-4 grid gap-4">
      <label>ì•„ì´ë””
        <div class="input-group">
          <input name="user_id" autocomplete="username" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required/>
          <button type="button" class="btn-duplicate">ì¤‘ë³µí™•ì¸</button>
        </div>
      </label>
      <label>ì„±í•¨<input name="name" autocomplete="name" placeholder="ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”" required/></label>
      <label>ë¹„ë°€ë²ˆí˜¸<input type="password" name="pw" autocomplete="new-password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required/></label>
      <label>ë¹„ë°€ë²ˆí˜¸ í™•ì¸<input type="password" name="pw_confirm" autocomplete="new-password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" required/></label>
      <label>ì—°ë½ì²˜
        <div class="input-group">
          <input name="phone" autocomplete="tel" placeholder="ì—°ë½ì²˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required/>
          <button type="button" class="btn-duplicate">ì¤‘ë³µí™•ì¸</button>
        </div>
      </label>
      <button id="joinSubmit" class="px-4 py-3 rounded-md bg-[#0ea5e9] text-white" type="submit">íšŒì›ê°€ì…</button>
    </form>
  </div>
</div>

<div id="loginModal" class="modal">
  <div class="win">
    <div class="hd"><div class="title">ë¡œê·¸ì¸</div><button id="loginClose" class="close">âœ•</button></div>
    <div class="mt-4 grid gap-4">
      <label>ì•„ì´ë””<input placeholder="ì•„ì´ë””"></label>
      <label>ë¹„ë°€ë²ˆí˜¸<input placeholder="ë¹„ë°€ë²ˆí˜¸" type="password"></label>
      <button class="px-4 py-3 rounded-md bg-[#0ea5e9] text-white">ë¡œê·¸ì¸</button>
    </div>
  </div>
</div>

<div id="joinDone" class="modal">
  <div class="win">
    <div class="hd"><div class="title">ê°€ì… ì™„ë£Œ</div><button id="doneClose" class="close">âœ•</button></div>
    <div class="mt-4 text-neutral-200 space-y-5">
      <a href="https://www.HCASINO2.COM" class="text-xl font-bold block text-center" target="_blank" rel="noopener">www.ev-62.com ì—ì„œ</a>
      <div class="text-center text-lg">ê°€ì…ì™„ë£Œí•˜ì‹ ë¶„ë§Œ!
1ë¶„ì„ í˜¸ë„ì²´í¬í•˜ê³ </div>
      <div class="flex justify-center">
        <button id="btnPref" class="px-6 py-3 rounded-md border border-yellow-400 text-yellow-200 text-lg font-bold">ì„ í˜¸ë„ ì¿ í°ë°›ê¸°</button>
      </div>
      <div class="text-xs text-neutral-400 text-center">*ê°€ì…í•˜ì‹  í›„ ì„ í˜¸ë„ ì¿ í°ë°›ê¸° ìˆœì„œë¡œ í•˜ì…”ì•¼ ì§€ê¸‰ë©ë‹ˆë‹¤..</div>
    </div>
  </div>
</div>

<div id="prefModal" class="modal">
  <div class="win">
    <div class="hd"><div class="title">1ë¶„ ì„ í˜¸ë„ ì²´í¬</div><button id="prefClose" class="close">âœ•</button></div>
    <div id="surveyWrap" class="mt-4">
        <div id="qTitle" class="survey-title"></div>
        <div id="qField" class="survey-field"></div>
        <div class="survey-actions">
            <button id="svBack" class="px-4 py-3 rounded-md bg-[#2a2f36] text-white flex-1" style="visibility:hidden">ì´ì „</button>
            <button id="svNext" class="px-4 py-3 rounded-md bg-[#0ea5e9] text-white flex-1 font-bold">ë‹¤ìŒ</button>
        </div>
    </div>
  </div>
</div>

<script>
/* Image loading helper */
function loadFirstAvailable(holder, base){
  const exts=['.png','.PNG','.jpg','.JPG','.jpeg','.JPEG'];
  let i=0; const img=new Image();
  img.onload=()=>{ img.className='w-full h-full object-cover'; holder.appendChild(img); };
  img.onerror=()=>{ i++; if(i<exts.length) img.src=`assets/${base}${exts[i]}`; };
  img.src=`assets/${base}${exts[i]}`;
}
document.querySelectorAll('[data-img]').forEach(el=>{
  const h=el.querySelector('.promo-holder'); if(h) loadFirstAvailable(h, el.dataset.img);
});

/* Modal open/close */
const joinModal=document.getElementById('joinModal');
const joinDone =document.getElementById('joinDone');
const loginModal=document.getElementById('loginModal');
const prefModal=document.getElementById('prefModal');
const openM=m=>{ m.style.display='flex'; document.body.style.overflow='hidden'; };
const closeM=m=>{ m.style.display='none'; document.body.style.overflow=''; };

/* buttons */
document.getElementById('btnJoin').addEventListener('click',()=>openM(joinModal));
document.getElementById('btnLogin').addEventListener('click',()=>openM(loginModal));
document.getElementById('promo-big').addEventListener('click',()=>openM(joinModal)); 
document.getElementById('btnVip').addEventListener('click',()=>alert('VIP í˜¸ì¶œ ê¸°ëŠ¥'));

/* join flow */
document.getElementById('joinForm').addEventListener('submit', (e) => {
    e.preventDefault();
    // ì‹¤ì œ ì„œë²„ ì „ì†¡ ë¡œì§ì´ ë“¤ì–´ê°ˆ ìë¦¬
    closeM(joinModal); 
    openM(joinDone);
});
document.getElementById('joinClose').addEventListener('click',()=>closeM(joinModal));
document.getElementById('doneClose').addEventListener('click',()=>closeM(joinDone));

/* login */
document.getElementById('loginClose').addEventListener('click',()=>closeM(loginModal));

/* Bottom Nav links -> Placeholder */
document.querySelectorAll('#bottomNav .nav-btn').forEach(el=>{
    el.addEventListener('click',()=>alert(`[${el.textContent.trim()}] í˜ì´ì§€ë¡œ ì´ë™ - ì½˜í…ì¸  ì¤€ë¹„ ì¤‘`));
});


/* ========================================================================= */
/* Preference (ë™ì  ì„¤ë¬¸) ë¡œì§ - 9ê°€ì§€ í•­ëª© */
/* ========================================================================= */

const SV = [
    {t:'hcasino2.com ì—ì„œ ì¿ í°ì„ ë°›ìœ¼ì‹¤ ì•„ì´ë””', kind:'input', name:'id', ph:'ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'},
    {t:'hcasino2.comì—ì„œ ê°€ì…í•  ë•Œ ê¸°ì…í•œ ì „í™”ë²ˆí˜¸', kind:'input', name:'phone', ph:'ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'},
    {t:'ì£¼ë¡œ í•˜ì‹œëŠ” ê²Œì„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”', kind:'radio', name:'game', opts:['ì¹´ì§€ë…¸','ìŠ¬ë¡¯','í† í† ','ì „ë¶€']},
    {t:'ë³´í†µ ì¼ì£¼ì¼ì— ê²Œì„ì„ ìœ„í•˜ì—¬ ì¶©ì „í•˜ì‹œëŠ” íšŸìˆ˜ëŠ”?', kind:'radio', name:'freq', opts:['1~2íšŒ','3~4íšŒ','5~6íšŒ','ê·¸ ì´ìƒ']},
    {t:'ìµœê·¼ 7ì¼ê°„ í”Œë ˆì´í•œ íšŸìˆ˜', kind:'radio', name:'recent', opts:['í•˜ë£¨','ì´í‹€','ì‚¬í˜','ê·¸ ì´ìƒ']},
    {t:'ì´ìš©í•˜ëŠ” ê³³ì„ ê³ ë¥¼ ë•Œ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ê²ƒì€?', kind:'radio', name:'point', opts:['ë¡¤ë§','ë³´ë„ˆìŠ¤','ì—…ì²´ëª…ì„±','ë‹´ë‹¹ íŒŒíŠ¸ë„ˆ']},
    {t:'í”Œë ˆì´ì–´ì˜ 1íšŒ í™˜ê¸‰ê¸ˆìœ¼ë¡œ ê°€ì¥ ê·¸ëŸ´ë“¯í•œ ê¸ˆì•¡ì€?', kind:'radio', name:'refund', opts:['50ë§Œì›','100ë§Œì›','300ë§Œì›','ê·¸ ì´ìƒ']},
    {t:'í˜¹ì‹œ ì˜¤ëŠ˜ ì¶©ì „í•˜ì‹¤ ê³„íšì´ ìˆìœ¼ì‹ ê°€ìš”?', kind:'radio', name:'today', opts:['ì˜¤ëŠ˜ í•©ë‹ˆë‹¤','ì¡°ê¸ˆ ê³ ë¯¼ì¤‘ì…ë‹ˆë‹¤','ì¿ í°ì€ ì–¸ì œì¯¤?']},
    {t:'í˜•ë‹˜ ìˆì–ìŠµë‹ˆê¹Œ?\nì²«ì¶©ì „ ê¸ˆì•¡ì˜ ë³´ë„ˆìŠ¤ 50%,\nìŠ¬ë¡¯ ìš”ìœ¨ 3%,ì—\në‹´ë‹¹ ë³´ë„ˆìŠ¤ ë‹¹ì¼ ì¶©ì „íšŸìˆ˜ë§ˆë‹¤ +1ë§Œ ë³´ë„ˆìŠ¤ë¡œ\nì¤€ë¹„í•´ë´¤ìŠµë‹ˆë‹¤.\n\nìë¦¬ í•œë²ˆ ë¹›ë‚´ì£¼ì‹œê² ìŠµë‹ˆê¹Œ?', kind:'radio', name:'final', opts:['ìƒê°í•´ë³¼ê»˜ìš”','OK']}
];
let si = 0; // Current survey index
let surveyData = {}; // To store answers

function showSV(si){
  const q = SV[si];
  document.getElementById('qTitle').innerHTML = q.t.replace(/\n/g,'<br/>');
  const field = document.getElementById('qField'); field.innerHTML = '';
  
  if(q.kind==='input'){
    const inp=document.createElement('input'); inp.className='survey-field-input input'; inp.name=q.name; inp.placeholder=q.ph||''; inp.required=true;
    inp.value = surveyData[q.name] || '';
    field.appendChild(inp);
  }else{
    q.opts.forEach((txt,i)=>{
      const lab=document.createElement('label'); lab.className='radio';
      const r=document.createElement('input'); r.type='radio'; r.name=q.name; r.value=txt;
      if(surveyData[q.name] === txt) r.checked = true;
      lab.appendChild(r);
      const sp=document.createElement('span'); sp.textContent=`${i+1}. ${txt}`;
      lab.appendChild(sp);
      field.appendChild(lab);
    });
  }
  document.getElementById('svBack').style.visibility = (si===0)?'hidden':'visible';
  document.getElementById('svNext').textContent = (si===SV.length-1)?'ì œì¶œ':'ë‹¤ìŒ';
}

function svNext(){
  const q = SV[si];
  const field = document.getElementById('qField');
  let value = null;

  if(q.kind==='input'){
    value=field.querySelector('input')?.value.trim();
    if (!value) { alert(`${q.t.split('\n')[0]}ì„(ë¥¼) ì…ë ¥í•´ì£¼ì„¸ìš”.`); return; }
  }else{
    value=field.querySelector('input[type="radio"]:checked')?.value;
    if (!value) { alert(`${q.t.split('\n')[0]}ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.`); return; }
  }

  // Save answer
  surveyData[q.name] = value;
  
  if (si < SV.length - 1) {
    si++;
    showSV(si);
  } else {
    // Final submission logic (GASë¡œ ì„¤ë¬¸ ë°ì´í„° ì „ì†¡)
    console.log('Survey Submitted:', surveyData);
    alert('ì„¤ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì¿ í°ì„ ì§€ê¸‰í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
    closeM(prefModal);
  }
}

// Button Listeners for Survey
document.getElementById('btnPref').addEventListener('click',()=>{ closeM(joinDone); si=0; surveyData={}; showSV(si); openM(prefModal); });
document.getElementById('svNext').addEventListener('click',svNext);
document.getElementById('svBack').addEventListener('click',()=>{ 
    if(si > 0) { si--; showSV(si); } 
});
document.getElementById('prefClose').addEventListener('click',()=>closeM(prefModal));


/* ========================================================================= */
/* ì¤‘ë³µí™•ì¸ ê¸°ëŠ¥ (ëª¨ë°”ì¼ ë²„ì „) - GAS ë¡œì§ ì ìš© */
/* ========================================================================= */

// ğŸš¨ ì¤‘ìš”: ì—¬ê¸°ì— ë°°í¬í•˜ì‹  êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì›¹ ì•± URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
const GAS_URL = "YOUR_DEPLOYED_GOOGLE_APPS_SCRIPT_URL_HERE";

// ğŸš¨ ì¤‘ìš”: ì¤‘ë³µ í™•ì¸ì„ í•  ìŠ¤í”„ë ˆë“œì‹œíŠ¸ IDì™€ ì‹œíŠ¸ íƒ­ ì´ë¦„ì„ ì„¤ì •í•˜ì„¸ìš”.
const SHEET_ID = "YOUR_SPREADSHEET_ID_HERE";
const SHEET_TAB = "ì‹œíŠ¸1"; 

// êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì¤‘ë³µ í™•ì¸ ìš”ì²­ì„ ë³´ë‚´ëŠ” í•¨ìˆ˜
async function checkDuplicate(field, value) {
    if (!GAS_URL.startsWith('https://script.google.com/macros/')) {
        alert("ğŸš¨ ì˜¤ë¥˜: GAS_URLì„ ì‹¤ì œ ë°°í¬ URLë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.");
        return { success: false, message: "URL ë¯¸ì„¤ì •" };
    }

    try {
        const response = await fetch(GAS_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                action: 'check_dup', 
                sheetId: SHEET_ID,
                tab: SHEET_TAB,
                field: field,
                value: value
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP ì˜¤ë¥˜: ${response.status}`);
        }

        const data = await response.json();
        return data;

    } catch (error) {
        console.error("ì¤‘ë³µ í™•ì¸ ìš”ì²­ ì˜¤ë¥˜:", error);
        alert(`ì¤‘ë³µ í™•ì¸ ì¤‘ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
        return { success: false, message: "í†µì‹  ì‹¤íŒ¨" };
    }
}

/* ì¤‘ë³µí™•ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ */
document.querySelectorAll('.btn-duplicate').forEach(button => {
    button.addEventListener('click', async (e) => {
        e.preventDefault();
        
        const inputGroup = button.closest('label').querySelector('.input-group');
        const inputField = inputGroup ? inputGroup.querySelector('input') : null;
        
        if (!inputField) return;

        const fieldName = inputField.getAttribute('name');
        const fieldLabel = fieldName === 'user_id' ? 'ì•„ì´ë””' : 'ì—°ë½ì²˜';
        const value = inputField.value.trim();
        
        if (value.length === 0) {
            alert(`${fieldLabel}ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
            inputField.focus();
            return;
        }

        const originalText = button.textContent;
        button.textContent = 'í™•ì¸ ì¤‘...';
        button.disabled = true;

        const result = await checkDuplicate(fieldName, value);

        button.textContent = originalText;
        button.disabled = false;

        if (result.success) {
            if (result.duplicate === true) {
                alert(`[${fieldLabel}] '${value}'ëŠ” ì´ë¯¸ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
            } else {
                alert(`[${fieldLabel}] '${value}'ëŠ” ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
            }
        } else {
            alert(`[${fieldLabel}] ì¤‘ë³µ í™•ì¸ ì‹¤íŒ¨: ${result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
        }
    });
});
</script>
</body>
</html>
